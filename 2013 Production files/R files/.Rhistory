plot(lakeParms$DOC,Edha)
summary(lm(Edha~lakeParms$DOC))
plot(avgSestonALAs[-c(5,12)],Eala)
plot(sestonALAs[-c(5,12)],Eala)
plot(sestonLINs[-c(5,12)],Elin)
head(chesson)
Script that makes data frame for Chesson's alpha (selectivity index) calculation for lipids in zooplankton#
#PTK 8 Oct 2013#
#
#data needed for script: 2012surveyLipidData_FINAL from lipids/final data#
setwd('~/Documents/Notre Dame/lipids/final data')#
#
lipids=read.csv('2012surveyLipidData_FINAL7Aug2013.csv',row.names=1) #loads data#
#need to make a data frame with all categorized lipids (2-37) with accompanied data#
samples=unique(lipids$sample) #makes vector of sampleIDs#
allLipids=c() #empty vector that will be a data frame of sampleIDs repeated 36 times#
for(i in 1:length(samples)){#
	x=data.frame(sample=rep(samples[i],36),peakNum=2:37)#
	allLipids=rbind(allLipids,x)#
} #
#
#match sample and peak numbers, add all accompanying data#
allLipids$uniqueID=paste(allLipids$sample,allLipids$peakNum,sep='')#
lipids$uniqueID=paste(lipids$sample, lipids$peakNum,sep='')#
#
percentArea=c()#
for(i in 1:nrow(allLipids)){ #for loop that matches the unique ID of allLipids and lipids data frame and makes vectors for each category in lipids #
	rowi=match(allLipids$uniqueID[i],lipids$uniqueID)#
	percentArea[i]=lipids$percentArea[rowi]#
#
}#
allLipids$percentArea=percentArea#
#
lakeID=c()#
sampleDate=c()#
group=c()#
taxa=c()#
for(i in 1:nrow(allLipids)){ #match allLipids to lipid data to get accompanying information (lake, date, group, etc)#
	rowi=match(allLipids$sample[i],lipids$sample)#
	lakeID[i]=toString(lipids$lakeID[rowi])#
	sampleDate[i]=toString(lipids$sampleDate[rowi])#
	group[i]=toString(lipids$group[rowi])#
	taxa[i]=toString(lipids$taxa[rowi])#
}#
allLipids$lakeID=lakeID#
allLipids$sampleDate=sampleDate#
allLipids$group=group#
allLipids$taxa=taxa #
#
#need to separate data frames into algae and zooplankton, and then will combine them in order to more easily calculate chessons alpha#
zoopLipids=allLipids[allLipids$group=='zoops',]#
algaeLipids=allLipids[allLipids$group=='algae',]#
#
need to convert %peak areas to lipid weights per unit mass or volume using mg DW and vol#
loads sample and extraction log#
setwd('~/Documents/Notre Dame/lipids/logs')#
extLog=read.csv('Lipid extraction log.csv')#
sampleLog=read.csv('Lipid sample log.csv')#
#
#add zoop weight to all Lipids data#
#weight=c()#
#extWt=c()#
#for(i in 1:nrow(zoopLipids)){#
#	rowi=match(zoopLipids$sample[i],extLog$extractionID)#
#	weight[i]=extLog[rowi,5]#
#	extWt[i]=extLog[rowi,4]#
#}#
#zoopLipids$lipids_ug=((zoopLipids$percentArea/100)*(weight*15))*1000 #multiply weight by 15 to get total lipid weight, and mulitply by percent peak area - multiply by 1000 to get into ug#
#zoopLipids$lipids_ugMgDW=zoopLipids$lipids_ug/extWt#
#
add per unit volume for algal lipids#
weight=c()#
vol=c()#
for(i in 1:nrow(algaeLipids)){#
	rowi=match(algaeLipids$sample[i],extLog$extractionID)#
	vol[i]=extLog[rowi,7]#
	weight[i]=extLog[rowi,5]#
}#
algaeLipids$lipids_ug=((algaeLipids$percentArea/100)*(weight*15))*1000 #calculate lipid weights as above#
algaeLipids$lipids_ugMl=algaeLipids$lipids_ug/vol#
#
#makes uniqueIDs for both zoop lipids and algae lipids that are lake_date_peak - will match data frames and make one combined#
algaeLipids$uniqueID=paste(algaeLipids$lakeID,algaeLipids$sampleDate,algaeLipids$peakNum,sep='_')#
zoopLipids$uniqueID=paste(zoopLipids$lakeID,zoopLipids$sampleDate,zoopLipids$peakNum,sep='_')#
#
algaePercent=c() #for loop that matches data by uniqueID, averages peaks#
algaeVolume=c()#
for(i in 1:nrow(zoopLipids)){#
	rowi=match(zoopLipids$uniqueID[i],algaeLipids$uniqueID)#
	x=algaeLipids[rowi,]#
	algaePercent[i]=mean(x$percentArea,na.rm=T)#
	algaeVolume[i]=mean(x$lipids_ugMl,na.rm=T)#
}#
zoopLipids$algae_percentArea=algaePercent#
zoopLipids$algae_ugMl=algaeVolume
head(zoopLipids)
zoopLipids
zoopLipids$algae_ugL=algaeVolume*1000
index=grep('NaN',zoopLipids$algae_percentArea) #replace NaN's with NAs#
zoopLipids$algae_percentArea[index]=NA
zoopLipids$algae_percentArea
index=grep('NaN',zoopLipids$algae_ugL)
index
zoopLipids$algae_ugL[index]=NA
zoopLipids$algae_ugL
setwd('~/Documents/Notre Dame/lipids/final data')#
#
write.csv(zoopLipids,'zoop_algaeLipidsForChessonsAlpha_8Oct2013.csv')
loads lipid data#
setwd('~/Documents/Notre Dame/lipids/final data')#
chesson=read.csv('zoop_algaeLipidsForChessonsAlpha_8Oct2013.csv',row.names=1)#
#
chesson$percentArea[is.na(chesson$percentArea)]<-0 #change NAs to 0#
chesson$algae_percentArea[is.na(chesson$algae_percentArea)]<-0#
#
chesson$E=(chesson$percentArea-chesson$algae_percentArea)/(chesson$percentArea+chesson$algae_percentArea) #E=selectivity index=(ri-pi)/(ri+pi)#
#
Eala=tapply(chesson$E[chesson$peakNum==22],chesson$lakeID[chesson$peakNum==22],mean,na.rm=T)[-c(5,12)] #E for ALA#
Elin=tapply(chesson$E[chesson$peakNum==19],chesson$lakeID[chesson$peakNum==19],mean,na.rm=T)[-c(5,12)] #E for LIN#
Eepa=tapply(chesson$E[chesson$peakNum==29],chesson$lakeID[chesson$peakNum==29],mean,na.rm=T)[-c(5,12)] #E for EPA#
Edha=tapply(chesson$E[chesson$peakNum==34],chesson$lakeID[chesson$peakNum==34],mean,na.rm=T)[-c(5,12)] #E for DHA#
#
#plot average selectivity indices vs DOC#
plot(lakeParms$DOC,Eala) #r2 = 0.51, p = 0.02#
plot(lakeParms$DOC,Elin) #r2 = 0.53, p = 0.02#
plot(lakeParms$DOC,Eepa) #r2 = 0.30, p = 0.10#
plot(lakeParms$DOC,Edha) #r2 = 0, p = 0.98
plot(lakeParms$DOC,Eala) #r2 = 0.51, p = 0.02
plot(chesson$algae_ug_L[chesson$peakNum==22],chesson$E[chesson$peakNum==22])
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22])
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22])
summary(lm(chesson$E[chesson$peakNum==22]~chesson$algae_ugL[chesson$peakNum==22]))
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19])
summary(lm(chesson$E[chesson$peakNum==19]~chesson$algae_ugL[chesson$peakNum==19]))
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.03 p = 0.17
summary(lm(chesson$E[chesson$peakNum==29]~chesson$algae_ugL[chesson$peakNum==29]))
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.03 p = 0.17
summary(lm(chesson$E[chesson$peakNum==34]~chesson$algae_ugL[chesson$peakNum==34]))
plot(chesson$algae_percent[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.03 p = 0.17
plot(chesson$algae_percent[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.03 p = 0.17
plot(lakeParms$DOC,Eala) #r2 = 0.51, p = 0.02
plot(lakeParms$DOC,Elin) #r2 = 0.53, p = 0.02
plot(lakeParms$DOC,Eepa) #r2 = 0.30, p = 0.10
plot(lakeParms$DOC,Edha) #r2 = 0, p = 0.98
plot(lakeParms$DOC,Eala) #r2 = 0.51, p = 0.02
sestonALAs[-c(5,12)]
plot(sestonALAs[-c(5,12)],Eala)
plot(sestonLINs[-c(5,12)],Elin)
summary(lm(Eala~sestonALAs[-c(5,12)]))
plot(sestonEPAs[-c(5,12)],Eepa)
plot(sestonDHAs[-c(5,12)],Edha)
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23
abline(h=0.8,col='red',lwd=2)
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23
abline(v=0.8,col='red',lwd=2)
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19]) #adj r2 = 0.03 p = 0.17
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
par(family='Times',pty='s',mfrow=c(2,2))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19]) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
par(family='Times',pty='s',mfrow=c(2,2),mar=c(1,1,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19]) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
par(family='Times',pty='s',mfrow=c(2,2),mar=c(2,2,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19]) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
par(family='Times',pty='s',mfrow=c(2,2),mar=c(2.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19]) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
par(family='Times',pty='s',mfrow=c(1,3),mar=c(2.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19]) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23
par(family='Times',pty='s',mfrow=c(3,1),mar=c(2.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22]) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19]) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29]) #adj r2 = 0.07 p = 0.23
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab=expression(paste('Seston ALA ',mu,'g L'^-1)),ylab=expression(paste('E'[ALA]))) #adj r2 = 0.13 p = 0.005
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA]))) #adj r2 = 0.13 p = 0.005
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])))#
abline(h=0.25)
plot(lakeParms$DOC,Elin) #r2 = 0.53, p = 0.02
plot(lakeParms$DOC,Eala) #r2 = 0.51, p = 0.02
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN]))) #adj r2 = 0.03 p = 0.17
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2) #adj r2 = 0.07 p = 0.23
plot E's vs seston concentrations#
par(family='Times',pty='s',mfrow=c(3,1),mar=c(2.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
par(family='Times',pty='s',mfrow=c(3,1),mar=c(2.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
par(family='Times',pty='s',mfrow=c(3,1),mar=c(2.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T)
plot E's vs seston concentrations#
par(family='Times',pty='s',mfrow=c(3,1),mar=c(4,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T)
plot E's vs seston concentrations#
par(family='Times',pty='s',mfrow=c(3,1),mar=c(3.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,at=-1)
par(family='Times',pty='s',mfrow=c(3,1),mar=c(3.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,at=-10)
par(family='Times',pty='s',mfrow=c(3,1),mar=c(3.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,at=10)
?mtext
par(family='Times',pty='s',mfrow=c(3,1),mar=c(3.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
#plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1)
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74
limitStatus=c()#
for(i in 1:nrow(chesson)){#
	if(chesson$E[i]>=0.25){#
		limitStatus[i]=1#
	}#
	else{#
		limitStatus=0#
	}#
}
limitStatus=c()#
for(i in 1:nrow(chesson)){#
	if(chesson$E[i]==NA){#
		limitStatus[i]=NA#
	}#
	else if(chesson$E[i]>=0.25){#
		limitStatus[i]=1#
	}#
	else{#
		limitStatus=0#
	}#
}
i=1
chesson$E[i]==NA
chesson$E[1]
chesson$E[i]=='NaN'
limitStatus=c()#
for(i in 1:nrow(chesson)){#
	if(chesson$E[i]=='NaN'){#
		limitStatus[i]=NA#
	}#
	else if(chesson$E[i]>=0.25){#
		limitStatus[i]=1#
	}#
	else{#
		limitStatus=0#
	}#
}
limitStatus
chesson$E
i=7
chesson$E[i]=='NaN'
chesson$E[i]>=0.25
chesson$E[i]
limitStatus[i]
chesson$E[i]=='NaN'
chesson$E[i]>=0.25
chesson$E[i]<0.25
limitStatus=c()#
for(i in 1:nrow(chesson)){#
	if(chesson$E[i]=='NaN'){#
		limitStatus[i]=NA#
	}#
	if(chesson$E[i]>=0.25){#
		limitStatus[i]=1#
	}#
	if(chesson$E[i]<0.25){#
		limitStatus[i]=0#
	}#
}
i=1
chesson$E[i]=='NaN'
limitStatus=c()#
for(i in 1:nrow(chesson)){#
	if(chesson$E[i]=='NaN'){#
		limitStatus[i]=NA#
	}#
	else if(chesson$E[i]>=0.25){#
		limitStatus[i]=1#
	}#
	else if(chesson$E[i]<0.25){#
		limitStatus[i]=0#
	}#
}
limitStatus
chesson$limitStatus=limitStatus
add DOC to chesson#
DOC=c()#
for(i in 1:nrow(chesson)){#
	rowi=match(chesson$lakeID[i],lakeParms$lakeID)#
	DOC[i]=lakeParms$DOC[rowi]#
}#
chesson$DOC=DOC
chesson$DOC
plot(chesson$limitStatus[chesson$peakNum==22],chesson$DOC[chesson$peakNum==22])
plot(chesson$DOC[chesson$peakNum==22],chesson$limitStatus[chesson$peakNum==22])
plot(chesson$DOC[chesson$peakNum==22],jitter(chesson$limitStatus[chesson$peakNum==22]))
plot(chesson$DOC[chesson$peakNum==22],jitter(chesson$limitStatus[chesson$peakNum==22]))
limitStatus=c()#
for(i in 1:nrow(chesson)){#
	if(chesson$E[i]=='NaN'){#
		limitStatus[i]=NA#
	}#
	else if(chesson$E[i]>=0.25){#
		limitStatus[i]=0#
	}#
	else if(chesson$E[i]<0.25){#
		limitStatus[i]=1#
	}#
}#
chesson$limitStatus=limitStatus#
#
#add DOC to chesson#
DOC=c()#
for(i in 1:nrow(chesson)){#
	rowi=match(chesson$lakeID[i],lakeParms$lakeID)#
	DOC[i]=lakeParms$DOC[rowi]#
}#
chesson$DOC=DOC#
#
plot(chesson$DOC[chesson$peakNum==22],jitter(chesson$limitStatus[chesson$peakNum==22]))
plot(chesson$DOC[chesson$peakNum==22],chesson$limitStatus[chesson$peakNum==22])
plot(chesson$DOC[chesson$peakNum==19],jitter(chesson$limitStatus[chesson$peakNum==19]))
plot(chesson$DOC[chesson$peakNum==29],jitter(chesson$limitStatus[chesson$peakNum==29]))
plot(chesson$DOC[chesson$peakNum==34],jitter(chesson$limitStatus[chesson$peakNum==34]))
plot(chesson$DOC[chesson$peakNum==22],jitter(chesson$limitStatus[chesson$peakNum==22]))
plot(chesson$DOC[chesson$peakNum==29],jitter(chesson$limitStatus[chesson$peakNum==29]))
mod29=glm(chesson$limitStatus[chesson$peakNum==29]~chesson$DOC[chesson$peakNum==29],family=binomial)
summary(mod29)
mod22=glm(chesson$limitStatus[chesson$peakNum==22]~chesson$DOC[chesson$peakNum==22,family=binomial])
mod22=glm(chesson$limitStatus[chesson$peakNum==22]~chesson$DOC[chesson$peakNum==22],family=binomial)
summary(mod22)
mod19=glm(chesson$limitStatus[chesson$peakNum==19]~chesson$DOC[chesson$peakNum==19],family=binomial)
summary(mod19)
summary(mod29)
ilogit<-function(x,beta){#
	prob=exp(cbind(1,x)%*%beta)/(1+exp(cbind(1,x)%*%beta))#
	return(prob)#
}
plot(chesson$DOC[chesson$peakNum==19],jitter(chesson$limitStatus[chesson$peakNum==19]))
plot(chesson$DOC[chesson$peakNum==19],jitter(chesson$limitStatus[chesson$peakNum==19]))
plot(chesson$DOC[chesson$peakNum==19],jitter(chesson$limitStatus[chesson$peakNum==19]))#
lines(seq(0,25,1),ilogit(seq(0,25,1),mod19$coefficients),lwd=2,col='red,lty=2')
plot(chesson$DOC[chesson$peakNum==19],jitter(chesson$limitStatus[chesson$peakNum==19]))#
lines(seq(0,25,1),ilogit(seq(0,25,1),mod19$coefficients),lwd=2,col='red',lty=2)
plot(chesson$DOC[chesson$peakNum==19],chesson$limitStatus[chesson$peakNum==19])#
lines(seq(0,25,1),ilogit(seq(0,25,1),mod19$coefficients),lwd=2,col='red',lty=2)
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$limitStatus[chesson$peakNum==19])
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$limitStatus[chesson$peakNum==19])
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$limitStatus[chesson$peakNum==22])
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$limitStatus[chesson$peakNum==29])
mod19=glm(chesson$limitStatus[chesson$peakNum==19]~chesson$algae_ugL[chesson$peakNUm==19],family=binomial)
mod19=glm(chesson$limitStatus[chesson$peakNum==19]~chesson$algae_ugL[chesson$peakNum==19],family=binomial)
summary(mod19)
mod22=glm(chesson$limitStatus[chesson$peakNum==22]~chesson$algae_ugL[chesson$peakNum==22],family=binomial)
summary(mod22)
mod29=glm(chesson$limitStatus[chesson$peakNum==29]~chesson$algae_ugL[chesson$peakNum==29],family=binomial)
summary(mod29)
ilogit<-function(x,beta){#
	prob=exp(cbind(1,x)%*%beta)/(1+exp(cbind(1,x)%*%beta))#
	return(prob)#
}
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$limitStatus[chesson$peakNum==19])#
lines(seq(0,25,1),ilogit(seq(0,25,1),mod19$coefficients))
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$limitStatus[chesson$peakNum==19])#
lines(seq(0,50,1),ilogit(seq(0,25,1),mod19$coefficients))
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$limitStatus[chesson$peakNum==19])#
lines(seq(0,50,1),ilogit(seq(0,50,1),mod19$coefficients))
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$limitStatus[chesson$peakNum==22])#
lines(seq(0,50,1),ilogit(seq(0,50,1),mod22$coefficients))
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$limitStatus[chesson$peakNum==29])#
lines(seq(0,50,1),ilogit(seq(0,50,1),mod29$coefficients))
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$limitStatus[chesson$peakNum==22])#
lines(seq(0,50,1),ilogit(seq(0,50,1),mod22$coefficients))
EFA limitation logistic regression#
#all Es above 0.25 = limited = 1, all below 0.25 not limited = 0#
limitStatus=c()#
for(i in 1:nrow(chesson)){#
	if(chesson$E[i]=='NaN'){#
		limitStatus[i]=NA#
	}#
	else if(chesson$E[i]>=0.25){#
		limitStatus[i]=1#
	}#
	else if(chesson$E[i]<0.25){#
		limitStatus[i]=0#
	}#
}#
chesson$limitStatus=limitStatus#
#
#add DOC to chesson#
DOC=c()#
for(i in 1:nrow(chesson)){#
	rowi=match(chesson$lakeID[i],lakeParms$lakeID)#
	DOC[i]=lakeParms$DOC[rowi]#
}#
chesson$DOC=DOC#
#
#plot limitation status by seston EFA concentration#
mod19=glm(chesson$limitStatus[chesson$peakNum==19]~chesson$algae_ugL[chesson$peakNum==19],family=binomial)#
summary(mod19)#
mod22=glm(chesson$limitStatus[chesson$peakNum==22]~chesson$algae_ugL[chesson$peakNum==22],family=binomial)#
summary(mod22)#
mod29=glm(chesson$limitStatus[chesson$peakNum==29]~chesson$algae_ugL[chesson$peakNum==29],family=binomial)#
summary(mod29)#
#
ilogit<-function(x,beta){#
	prob=exp(cbind(1,x)%*%beta)/(1+exp(cbind(1,x)%*%beta))#
	return(prob)#
}#
#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$limitStatus[chesson$peakNum==19])#
lines(seq(0,50,1),ilogit(seq(0,50,1),mod19$coefficients))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$limitStatus[chesson$peakNum==22])#
lines(seq(0,50,1),ilogit(seq(0,50,1),mod22$coefficients))
par(family='Times',pty='s',mfrow=c(2,2),mar=c(3.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1)
setwd('~/Documents/Notre Dame/UNDERC 2012/paper')
list.files()
setwd('~/Documents/Notre Dame/UNDERC 2012/paper/figure drafts')
list.files()
setwd('~/Documents/Notre Dame/UNDERC 2012/paper/figure drafts/pdfs')#
pdf(file='fig3_zoopSelectivityEFAs_10Oct2013',height=11,width=8.5)#
par(family='Times',pty='s',mfrow=c(2,2),mar=c(3.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1)#
dev.off()
par(family='Times',pty='s',mfrow=c(2,2),mar=c(3.5,2.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34]) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1)
par(family='Times',pty='s',mfrow=c(2,2),mar=c(3.5,3.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34],xlab='',ylab=expression(paste('E'[DHA])),cex=1.2) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1)
par(family='Times',pty='s',mfrow=c(2,2),mar=c(3.5,3.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2,cex.lab=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34],xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1,cex=1.2)
setwd('~/Documents/Notre Dame/UNDERC 2012/paper/figure drafts/pdfs')#
pdf(file='fig3_zoopSelectivityEFAs_10Oct2013',height=8.5,width=8.5)#
par(family='Times',pty='s',mfrow=c(2,2),mar=c(3.5,3.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2,cex.lab=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34],xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1,cex=1.2)#
dev.off()
setwd('~/Documents/Notre Dame/UNDERC 2012/paper/figure drafts/pdfs')#
pdf(file='fig3_zoopSelectivityEFAs_10Oct2013',height=8.5,width=8.5)#
par(family='Times',pty='s',mfrow=c(2,2),mar=c(4,4,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2,cex.lab=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34],xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1,cex=1.2)#
dev.off()
par(family='Times',pty='s',mfrow=c(2,2),mar=c(4.5,4.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2,cex.lab=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34],xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1,cex=1.5)
setwd('~/Documents/Notre Dame/UNDERC 2012/paper/figure drafts/pdfs')#
pdf(file='fig3_zoopSelectivityEFAs_10Oct2013',height=8.5,width=8.5)#
par(family='Times',pty='s',mfrow=c(2,2),mar=c(4.5,4.5,1,1))#
plot(chesson$algae_ugL[chesson$peakNum==22],chesson$E[chesson$peakNum==22],xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.13 p = 0.005#
plot(chesson$algae_ugL[chesson$peakNum==19],chesson$E[chesson$peakNum==19],ylab=expression(paste('E'[LIN])),xlab='',cex=1.2,cex.lab=1.2) #adj r2 = 0.03 p = 0.17#
plot(chesson$algae_ugL[chesson$peakNum==29],chesson$E[chesson$peakNum==29],xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2)#
abline(v=0.8,lwd=1.5,lty=2) #adj r2 = 0.07 p = 0.23#
plot(chesson$algae_ugL[chesson$peakNum==34],chesson$E[chesson$peakNum==34],xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2) #adj r2 = 0.005 p = 0.74#
mtext(expression(paste('EFA ',mu,'g L'^-1)),side=1,outer=T,line=-1,cex=1.5)#
dev.off()
Eepa
length(chesson$E[chesson$peakNum==29 & chesson$E==1])
length(chesson$E[chesson$peakNum==29])
69/94
length(chesson$E[chesson$peakNum==22 & chesson$E==1])
length(chesson$E[chesson$peakNum==22])
35/94
mean(Eepa)
mean(Eala)
summary(mod19)
summary(mod22)
summary(mod29)
length(chesson$E[chesson$peakNum==29 & chesson$E>=0.25])
length(chesson$E[chesson$peakNum==29])
82/94
length(chesson$E[chesson$peakNum==22 & chesson$E>=0.25])
67/94
length(chesson$E[chesson$peakNum==19 & chesson$E>=0.25])
76/94
length(chesson$E[chesson$peakNum==34 & chesson$E>=0.25])
mean(Eepa)
mean(Eala)
mean(Elin)
mean(Edha)
plot(lakeParms$DOC,Eepa) #r2 = 0.30, p = 0.10
Eepa
Eala
sestonEPAs
sestonEPAs*1000
Eara=tapply(chesson$E[chesson$peakNum==28],chesson$lakeID[chesson$peakNum==28],mean,na.rm=T)[-c(5,12)] #E for ARA
Eara
plot(lakeParms$DOC,Eara)
summary(lm(Eara~lakeParms$DOC))
plot(chesson$algae_ugL[chesson$peakNum==28],chesson$E[chesson$peakNum==28])
sestonARAs[-c(5,12)]
sestonARAs[-c(5,12)]*1000
plot(lakeParms$DOC,Eala) #r2 = 0.51, p = 0.02
SEala=tapply(chesson$E[chesson$peakNum==22],chesson$lakeID[chesson$peakNum==22],std.error,na.rm=T)[-c(5,12)]
SEala
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala))) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala))) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala)),pch=19) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)
SElin=tapply(chesson$E[chesson$peakNum==19],chesson$lakeID[chesson$peakNum==19],std.error,na.rm=T)[-c(5,12)]
SEepa=tapply(chesson$E[chesson$peakNum==29],chesson$lakeID[chesson$peakNum==29],std.error,na.rm=T)[-c(5,12)]
SEdha=tapply(chesson$E[chesson$peakNum==34],chesson$lakeID[chesson$peakNum==34],std.error,na.rm=T)[-c(5,12)]
plot(lakeParms$DOC,Elin,xlab='',ylab=expression(paste('E'[LIN])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Elin-SElin),max(Elin+SElin))) #r2 = 0.53, p = 0.02#
errbar(lakeParms$DOC,Elin,yplus=Elin+SElin,yminus=Elin-SElin,add=T)
plot(lakeParms$DOC,Eepa,xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Eepa-SEepa),max(Eepa+SEepa))) #r2 = 0.30, p = 0.10#
errbar(lakeParms$DOC,Eepa,yplus=Eepa+SEepa,yminus=Eepa-SEepa,add=T)
plot(lakeParms$DOC,Edha,xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Edha-SEdha),max(Edha+SEdha))) #r2 = 0, p = 0.98
plot(lakeParms$DOC,Edha,xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Edha-SEdha),max(Edha+SEdha))) #r2 = 0, p = 0.98#
errbar(lakeParms$DOC,Edha,yplus=Edha+SEdha,yminus=Edha-SEdha,add=T)
par(for=c(2,2),family='Times',pty='s',mar=c(4.5,4.5,1,1))#
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala)),pch=19) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)#
plot(lakeParms$DOC,Elin,xlab='',ylab=expression(paste('E'[LIN])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Elin-SElin),max(Elin+SElin))) #r2 = 0.53, p = 0.02#
errbar(lakeParms$DOC,Elin,yplus=Elin+SElin,yminus=Elin-SElin,add=T)#
plot(lakeParms$DOC,Eepa,xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Eepa-SEepa),max(Eepa+SEepa))) #r2 = 0.30, p = 0.10#
errbar(lakeParms$DOC,Eepa,yplus=Eepa+SEepa,yminus=Eepa-SEepa,add=T)#
plot(lakeParms$DOC,Edha,xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Edha-SEdha),max(Edha+SEdha))) #r2 = 0, p = 0.98#
errbar(lakeParms$DOC,Edha,yplus=Edha+SEdha,yminus=Edha-SEdha,add=T)#
#
mtext(expression(paste('DOC mg L'^-1)),side=1,outer=T,line=-1,cex=1.5)
par(mfrow=c(2,2),family='Times',pty='s',mar=c(4.5,4.5,1,1))#
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala)),pch=19) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)#
plot(lakeParms$DOC,Elin,xlab='',ylab=expression(paste('E'[LIN])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Elin-SElin),max(Elin+SElin))) #r2 = 0.53, p = 0.02#
errbar(lakeParms$DOC,Elin,yplus=Elin+SElin,yminus=Elin-SElin,add=T)#
plot(lakeParms$DOC,Eepa,xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Eepa-SEepa),max(Eepa+SEepa))) #r2 = 0.30, p = 0.10#
errbar(lakeParms$DOC,Eepa,yplus=Eepa+SEepa,yminus=Eepa-SEepa,add=T)#
plot(lakeParms$DOC,Edha,xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Edha-SEdha),max(Edha+SEdha))) #r2 = 0, p = 0.98#
errbar(lakeParms$DOC,Edha,yplus=Edha+SEdha,yminus=Edha-SEdha,add=T)#
#
mtext(expression(paste('DOC mg L'^-1)),side=1,outer=T,line=-1,cex=1.5)
setwd('~/Documents/Notre Dame/UNDERC 2012/paper/figure drafts/pdfs')#
pdf(file='fig4_selectivityVsDOC_11Oct2013',height=8.5,width=8.5)#
par(mfrow=c(2,2),family='Times',pty='s',mar=c(4.5,4.5,1,1))#
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala)),pch=19) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)#
plot(lakeParms$DOC,Elin,xlab='',ylab=expression(paste('E'[LIN])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Elin-SElin),max(Elin+SElin))) #r2 = 0.53, p = 0.02#
errbar(lakeParms$DOC,Elin,yplus=Elin+SElin,yminus=Elin-SElin,add=T)#
plot(lakeParms$DOC,Eepa,xlab='',ylab=expression(paste('E'[EPA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Eepa-SEepa),max(Eepa+SEepa))) #r2 = 0.30, p = 0.10#
errbar(lakeParms$DOC,Eepa,yplus=Eepa+SEepa,yminus=Eepa-SEepa,add=T)#
plot(lakeParms$DOC,Edha,xlab='',ylab=expression(paste('E'[DHA])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(min(Edha-SEdha),max(Edha+SEdha))) #r2 = 0, p = 0.98#
errbar(lakeParms$DOC,Edha,yplus=Edha+SEdha,yminus=Edha-SEdha,add=T)#
#
mtext(expression(paste('DOC mg L'^-1)),side=1,outer=T,line=-1,cex=1.5)#
dev.off()
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala)),xlim=c(-1,1),pch=19) #r2 = 0.51, p = 0.02
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2,ylim=c(min(Eala-SEala),max(Eala+SEala)),xlim=c(-1,1),pch=19) #r2 = 0.51, p = 0.02#
errbar(lakeParms$DOC,Eala,yplus=Eala+SEala,yminu=Eala-SEala,add=T)
plot(lakeParms$DOC,Eala,xlab='',ylab=expression(paste('E'[ALA])),cex=1.2,cex.lab=1.2,ylim=c(-1,1),pch=19) #r2 = 0.51, p = 0.02
plot(lakeParms$DOC,Elin,xlab='',ylab=expression(paste('E'[LIN])),cex=1.2,cex.lab=1.2,pch=19,ylim=c(-1,1)) #r2 = 0.53, p = 0.02
lipids
head(lipids)
sestonFAs'
;
)
x
c
''
head(sestonFAs)
sestonw3w6
plot(lakeParms$DOC,sestonw3w6)
plot(lakeParms$DOC,sestonw3w6[-c(5,12)])
summary(lm(sestonFAs$sestonw3w6~sestonFAs$DOC+as.factor(sestonFAs$samplePoint)))
summary(lm(sestonFAs$sestonw3w6~sestonFAs$DOC))
summary(lm(sestonFAs$sestonw3w6~sestonFAs$kD))
plot(sestonFAs$kD,sestonFAs$sestonw3w6)
plot(sestonFAs$kD,sestonFAs$sestonw3w6,ylim=c(0,20))
seston
head(seston)
seston[seston$CP>300,]
nrow(seston)
2/56
head(chesson)
nrow(chesson)
Eepa
Eala
Elin
Early data anlysis for Long Lake production for 2013#
#Patrick Kelly#
#2 July 2013#
#
#load data#
setwd('~/Documents/Notre Dame/Long Lake Data/2013 Production files/R files')#
#
lengthsFile='longLakeZoopLengths2013_2July.csv'#
countFile='ZoopCounts2013_2July.csv'#
subsampleFile='zoopSubsampleWeight2013_2July.csv'#
regressionFile='LWregressions.csv'#
#
lengths=read.csv(lengthsFile)#
counts=read.csv(countFile)#
subsampleWeights=read.csv(subsampleFile)#
regressionCofs=read.csv(regressionFile)#
#
#calculate mass for each zoop#
mass_ug=c()#
for(i in 1:nrow(lengths)){#
	rowi=match(lengths$taxa[i],regressionCofs$taxa)#
	mass_ug[i]=exp((regressionCofs$b[rowi]+(regressionCofs$m[rowi]*log(lengths$length.mm[i]))))#
}#
lengths$mass_ug=mass_ug#
#
#calculate subsample multipliers#
subsampleMult=subsampleWeights$weight.subsample/(subsampleWeights$weight.jar.full-subsampleWeights$weight.empty.jar)#
subsampleWeights$subsampleMult=subsampleMult#
#
#calculate counts per m2#
for(i in 1:nrow(counts)){#
	rowi=match(counts$Zoop.ID[i],subsampleWeights$Zoop.ID)#
	counts$sampleCount[i]=counts$Counts[i]/subsampleWeights$subsampleMult[rowi]#
}	#
#
counts$countsPerM2=(((counts$sampleCount/2)/0.07297)/0.25)#
#
#add average lengths to count data#
lengths$uniqueID=paste(lengths$sampleNum,lengths$taxa,sep='')#
avgBiomass=tapply(lengths$mass_ug,lengths$uniqueID,mean,na.rm=T)#
#
#make data frame with uniqueIDs and averages#
avgMass=data.frame(uniqueID=rownames(avgBiomass),avgBiomass)#
rownames(avgMass)=NULL#
#
#make unique IDs for count data#
counts$uniqueID=paste(counts$Zoop.ID,counts$Taxa,sep='')#
#
#match counts and lengths#
for(i in 1:nrow(counts)){#
	rowi=match(counts$uniqueID[i],avgMass$uniqueID)#
	counts$avgBiomass_ug[i]=avgMass$avgBiomass[rowi]#
}#
#
#use just East and West Long#
LOcounts=counts[counts$Lake.ID=='EL' | counts$Lake.ID=='WL',]#
#
#find mass in grams per m2#
LOcounts$totalBiomass_gM2=LOcounts$countsPerM2*(LOcounts$avgBiomass_ug/10^6)#
#find average biomass per taxa per lake#
ELtaxaBiomass=tapply(LOcounts$totalBiomass_gM2[LOcounts$Lake.ID=='EL'], LOcounts$Taxa[LOcounts$Lake.ID=='EL'],mean,na.rm=T)#
WLtaxaBiomass=tapply(LOcounts$totalBiomass_gM2[LOcounts$Lake.ID=='WL'], LOcounts$Taxa[LOcounts$Lake.ID=='WL'],mean,na.rm=T)#
#
#find maximum biomass per taxa for each lake#
ELmaxBiomass=tapply(lengths$mass_ug[lengths$lakeID=='EL'],lengths$taxa[lengths$lakeID=='EL'],max,na.rm=T)#
WLmaxBiomass=tapply(lengths$mass_ug[lengths$lakeID=='WL'],lengths$taxa[lengths$lakeID=='WL'],max,na.rm=T)#
#
#Calculate production using Plante and Downing 1980-whatever #
ELprod=0.06+(0.79*log(ELtaxaBiomass[-6],10))-(0.16*log(ELmaxBiomass[-3]*1000,10))+(0.05*21)#
WLprod=0.06+(0.79*log(WLtaxaBiomass[-6],10))-(0.16*log(WLmaxBiomass[-3]*1000,10))+(0.05*21)#
ELprod=10^ELprod#
WLprod=10^WLprod
ELprod
ELprod=0.06+(0.79*log(ELtaxaBiomass[-6],10))-(0.16*log(ELmaxBiomass[-3]/1000,10))+(0.05*21)
WLprod=0.06+(0.79*log(WLtaxaBiomass[-6],10))-(0.16*log(WLmaxBiomass[-3]/1000,10))+(0.05*21)
ELprod=10^ELprod
WLprod=10^WLprod
ELprod
WLprod
barplot(c(sum(WLprod),sum(ELprod)))
barplot(c(sum(WLprod,na.rm=T),sum(ELprod,na.rm=T)))
